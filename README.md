# python-soccerAnalytics

私がデータ分析を行い、分析結果を視覚的に表現するまでの思考、工程です。

→録画した動画を準備しOpenCVを使用して動画を読み込む。

→フレームの前処理として、ノイズの除去とエッジの強調などを行う。

  ・ノイズの除去、denoised = cv2.fastNlMeansDenoising(gray, h=10)
  
  ・エッジ強調、 edges = cv2.Canny(denoised, threshold1=30, threshold2=70)

→特定のフレーム範囲の処理の実行にも対応させる

  ・例えばstart_frameとend_frameを設定し、指定した範囲のみ処理を行うcurrent_frame変数を使用して現在のフレームを追跡し、if文で範囲の条件判定を行う。

→後続の分析やデバッグに利用できるように、フレームを保存する処理を実行させる

  ・指定した変数に保存先ディレクトリのパスを指定し、cv2.imwrite()関数を使用し指定したパスに保存させる。

→処理速度が重要な場合にも対応ができるよう、並列処理の導入を行う

  ・TreadPoolExecutor()を使用しマルチスレッドな並列処理を行う
  ＊OpenCVはスレッドセーフではないため同時呼び出しには注意が必要。

→フレームの分析において、背景差分法を活用する

  ・平均値法を使い、試合前の静止画像、背景フレームの各ピクセルの値を時間軸方向に平均化し、ピクセルの値を取り出し、各ピクセルの背景の平均値を得てモデル作成を行う
  ・試合中では現在のフレームと背景の平均値との差分を計算する。平均値を引くことで前傾領域を検出する

また、以下のURLを参考にしながら背景差分法を活用しました。

https://pystyle.info/opencv-background-substraction/

→シーン抽出に関して

  ・ビルドアップ時の場合、（縦x、横yとします）ピッチをx軸に3分割し、自チームのフィールドプレイヤーのx座標代表値を算出しそれが35m以上70m未満、且つボールの状態が自チームの保持である条件を設定させ、条件を満たした場合、Pandusのデータフレームに格納する。

また、以下のURLを参考にしながらシーン抽出を活用しました。

https://note.com/keigo_ashiki/n/n5e85a0592a67

以上の工程を基に、攻撃シーンや守備シーンなどにタグ付けを行い、データの整理や分析を効率的に行うことができました。
